{"ast":null,"code":"/*!\n * lightgallery | 2.6.1 | September 14th 2022\n * http://www.lightgalleryjs.com/\n * Copyright (c) 2020 Sachin Neravath;\n * @license GPLv3\n */\n\n/*! *****************************************************************************\r\nCopyright (c) Microsoft Corporation.\r\n\r\nPermission to use, copy, modify, and/or distribute this software for any\r\npurpose with or without fee is hereby granted.\r\n\r\nTHE SOFTWARE IS PROVIDED \"AS IS\" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH\r\nREGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY\r\nAND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,\r\nINDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM\r\nLOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR\r\nOTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR\r\nPERFORMANCE OF THIS SOFTWARE.\r\n***************************************************************************** */\nvar __assign = function () {\n  __assign = Object.assign || function __assign(t) {\n    for (var s, i = 1, n = arguments.length; i < n; i++) {\n      s = arguments[i];\n\n      for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];\n    }\n\n    return t;\n  };\n\n  return __assign.apply(this, arguments);\n};\n\nvar videoSettings = {\n  autoplayFirstVideo: true,\n  youTubePlayerParams: false,\n  vimeoPlayerParams: false,\n  wistiaPlayerParams: false,\n  gotoNextSlideOnVideoEnd: true,\n  autoplayVideoOnSlide: false,\n  videojs: false,\n  videojsTheme: '',\n  videojsOptions: {}\n};\n/**\r\n * List of lightGallery events\r\n * All events should be documented here\r\n * Below interfaces are used to build the website documentations\r\n * */\n\nvar lGEvents = {\n  afterAppendSlide: 'lgAfterAppendSlide',\n  init: 'lgInit',\n  hasVideo: 'lgHasVideo',\n  containerResize: 'lgContainerResize',\n  updateSlides: 'lgUpdateSlides',\n  afterAppendSubHtml: 'lgAfterAppendSubHtml',\n  beforeOpen: 'lgBeforeOpen',\n  afterOpen: 'lgAfterOpen',\n  slideItemLoad: 'lgSlideItemLoad',\n  beforeSlide: 'lgBeforeSlide',\n  afterSlide: 'lgAfterSlide',\n  posterClick: 'lgPosterClick',\n  dragStart: 'lgDragStart',\n  dragMove: 'lgDragMove',\n  dragEnd: 'lgDragEnd',\n  beforeNextSlide: 'lgBeforeNextSlide',\n  beforePrevSlide: 'lgBeforePrevSlide',\n  beforeClose: 'lgBeforeClose',\n  afterClose: 'lgAfterClose',\n  rotateLeft: 'lgRotateLeft',\n  rotateRight: 'lgRotateRight',\n  flipHorizontal: 'lgFlipHorizontal',\n  flipVertical: 'lgFlipVertical',\n  autoplay: 'lgAutoplay',\n  autoplayStart: 'lgAutoplayStart',\n  autoplayStop: 'lgAutoplayStop'\n};\n\nvar param = function (obj) {\n  return Object.keys(obj).map(function (k) {\n    return encodeURIComponent(k) + '=' + encodeURIComponent(obj[k]);\n  }).join('&');\n};\n\nvar getVimeoURLParams = function (defaultParams, videoInfo) {\n  if (!videoInfo || !videoInfo.vimeo) return '';\n  var urlParams = videoInfo.vimeo[2] || '';\n  var defaultPlayerParams = defaultParams && Object.keys(defaultParams).length !== 0 ? '&' + param(defaultParams) : ''; // Support private video\n\n  var urlWithHash = videoInfo.vimeo[0].split('/').pop() || '';\n  var urlWithHashWithParams = urlWithHash.split('?')[0] || '';\n  var hash = urlWithHashWithParams.split('#')[0];\n  var isPrivate = videoInfo.vimeo[1] !== hash;\n\n  if (isPrivate) {\n    urlParams = urlParams.replace(\"/\" + hash, '');\n  }\n\n  urlParams = urlParams[0] == '?' ? '&' + urlParams.slice(1) : urlParams || ''; // For vimeo last params gets priority if duplicates found\n\n  var vimeoPlayerParams = \"?autoplay=0&muted=1\" + (isPrivate ? \"&h=\" + hash : '') + defaultPlayerParams + urlParams;\n  return vimeoPlayerParams;\n};\n/**\r\n * Video module for lightGallery\r\n * Supports HTML5, YouTube, Vimeo, wistia videos\r\n *\r\n *\r\n * @ref Wistia\r\n * https://wistia.com/support/integrations/wordpress(How to get url)\r\n * https://wistia.com/support/developers/embed-options#using-embed-options\r\n * https://wistia.com/support/developers/player-api\r\n * https://wistia.com/support/developers/construct-an-embed-code\r\n * http://jsfiddle.net/xvnm7xLm/\r\n * https://developer.mozilla.org/en-US/docs/Web/HTML/Element/video\r\n * https://wistia.com/support/embed-and-share/sharing-videos\r\n * https://private-sharing.wistia.com/medias/mwhrulrucj\r\n *\r\n * @ref Youtube\r\n * https://developers.google.com/youtube/player_parameters#enablejsapi\r\n * https://developers.google.com/youtube/iframe_api_reference\r\n * https://developer.chrome.com/blog/autoplay/#iframe-delegation\r\n *\r\n * @ref Vimeo\r\n * https://stackoverflow.com/questions/10488943/easy-way-to-get-vimeo-id-from-a-vimeo-url\r\n * https://vimeo.zendesk.com/hc/en-us/articles/360000121668-Starting-playback-at-a-specific-timecode\r\n * https://vimeo.zendesk.com/hc/en-us/articles/360001494447-Using-Player-Parameters\r\n */\n\n\nvar Video =\n/** @class */\nfunction () {\n  function Video(instance) {\n    // get lightGallery core plugin instance\n    this.core = instance;\n    this.settings = __assign(__assign({}, videoSettings), this.core.settings);\n    return this;\n  }\n\n  Video.prototype.init = function () {\n    var _this = this;\n    /**\r\n     * Event triggered when video url found without poster\r\n     * Append video HTML\r\n     * Play if autoplayFirstVideo is true\r\n     */\n\n\n    this.core.LGel.on(lGEvents.hasVideo + \".video\", this.onHasVideo.bind(this));\n    this.core.LGel.on(lGEvents.posterClick + \".video\", function () {\n      var $el = _this.core.getSlideItem(_this.core.index);\n\n      _this.loadVideoOnPosterClick($el);\n    });\n    this.core.LGel.on(lGEvents.slideItemLoad + \".video\", this.onSlideItemLoad.bind(this)); // @desc fired immediately before each slide transition.\n\n    this.core.LGel.on(lGEvents.beforeSlide + \".video\", this.onBeforeSlide.bind(this)); // @desc fired immediately after each slide transition.\n\n    this.core.LGel.on(lGEvents.afterSlide + \".video\", this.onAfterSlide.bind(this));\n  };\n  /**\r\n   * @desc Event triggered when a slide is completely loaded\r\n   *\r\n   * @param {Event} event - lightGalley custom event\r\n   */\n\n\n  Video.prototype.onSlideItemLoad = function (event) {\n    var _this = this;\n\n    var _a = event.detail,\n        isFirstSlide = _a.isFirstSlide,\n        index = _a.index; // Should check the active slide as well as user may have moved to different slide before the first slide is loaded\n\n    if (this.settings.autoplayFirstVideo && isFirstSlide && index === this.core.index) {\n      // Delay is just for the transition effect on video load\n      setTimeout(function () {\n        _this.loadAndPlayVideo(index);\n      }, 200);\n    } // Should not call on first slide. should check only if the slide is active\n\n\n    if (!isFirstSlide && this.settings.autoplayVideoOnSlide && index === this.core.index) {\n      this.loadAndPlayVideo(index);\n    }\n  };\n  /**\r\n   * @desc Event triggered when video url or poster found\r\n   * Append video HTML is poster is not given\r\n   * Play if autoplayFirstVideo is true\r\n   *\r\n   * @param {Event} event - Javascript Event object.\r\n   */\n\n\n  Video.prototype.onHasVideo = function (event) {\n    var _a = event.detail,\n        index = _a.index,\n        src = _a.src,\n        html5Video = _a.html5Video,\n        hasPoster = _a.hasPoster;\n\n    if (!hasPoster) {\n      // All functions are called separately if poster exist in loadVideoOnPosterClick function\n      this.appendVideos(this.core.getSlideItem(index), {\n        src: src,\n        addClass: 'lg-object',\n        index: index,\n        html5Video: html5Video\n      }); // Automatically navigate to next slide once video reaches the end.\n\n      this.gotoNextSlideOnVideoEnd(src, index);\n    }\n  };\n  /**\r\n   * @desc fired immediately before each slide transition.\r\n   * Pause the previous video\r\n   * Hide the download button if the slide contains YouTube, Vimeo, or Wistia videos.\r\n   *\r\n   * @param {Event} event - Javascript Event object.\r\n   * @param {number} prevIndex - Previous index of the slide.\r\n   * @param {number} index - Current index of the slide\r\n   */\n\n\n  Video.prototype.onBeforeSlide = function (event) {\n    if (this.core.lGalleryOn) {\n      var prevIndex = event.detail.prevIndex;\n      this.pauseVideo(prevIndex);\n    }\n  };\n  /**\r\n   * @desc fired immediately after each slide transition.\r\n   * Play video if autoplayVideoOnSlide option is enabled.\r\n   *\r\n   * @param {Event} event - Javascript Event object.\r\n   * @param {number} prevIndex - Previous index of the slide.\r\n   * @param {number} index - Current index of the slide\r\n   * @todo should check on onSlideLoad as well if video is not loaded on after slide\r\n   */\n\n\n  Video.prototype.onAfterSlide = function (event) {\n    var _this = this;\n\n    var _a = event.detail,\n        index = _a.index,\n        prevIndex = _a.prevIndex; // Do not call on first slide\n\n    var $slide = this.core.getSlideItem(index);\n\n    if (this.settings.autoplayVideoOnSlide && index !== prevIndex) {\n      if ($slide.hasClass('lg-complete')) {\n        setTimeout(function () {\n          _this.loadAndPlayVideo(index);\n        }, 100);\n      }\n    }\n  };\n\n  Video.prototype.loadAndPlayVideo = function (index) {\n    var $slide = this.core.getSlideItem(index);\n    var currentGalleryItem = this.core.galleryItems[index];\n\n    if (currentGalleryItem.poster) {\n      this.loadVideoOnPosterClick($slide, true);\n    } else {\n      this.playVideo(index);\n    }\n  };\n  /**\r\n   * Play HTML5, Youtube, Vimeo or Wistia videos in a particular slide.\r\n   * @param {number} index - Index of the slide\r\n   */\n\n\n  Video.prototype.playVideo = function (index) {\n    this.controlVideo(index, 'play');\n  };\n  /**\r\n   * Pause HTML5, Youtube, Vimeo or Wistia videos in a particular slide.\r\n   * @param {number} index - Index of the slide\r\n   */\n\n\n  Video.prototype.pauseVideo = function (index) {\n    this.controlVideo(index, 'pause');\n  };\n\n  Video.prototype.getVideoHtml = function (src, addClass, index, html5Video) {\n    var video = '';\n    var videoInfo = this.core.galleryItems[index].__slideVideoInfo || {};\n    var currentGalleryItem = this.core.galleryItems[index];\n    var videoTitle = currentGalleryItem.title || currentGalleryItem.alt;\n    videoTitle = videoTitle ? 'title=\"' + videoTitle + '\"' : '';\n    var commonIframeProps = \"allowtransparency=\\\"true\\\"\\n            frameborder=\\\"0\\\"\\n            scrolling=\\\"no\\\"\\n            allowfullscreen\\n            mozallowfullscreen\\n            webkitallowfullscreen\\n            oallowfullscreen\\n            msallowfullscreen\";\n\n    if (videoInfo.youtube) {\n      var videoId = 'lg-youtube' + index;\n      var slideUrlParams = videoInfo.youtube[2] ? videoInfo.youtube[2] + '&' : ''; // For youtube first parms gets priority if duplicates found\n\n      var youTubePlayerParams = \"?\" + slideUrlParams + \"wmode=opaque&autoplay=0&mute=1&enablejsapi=1\";\n      var playerParams = youTubePlayerParams + (this.settings.youTubePlayerParams ? '&' + param(this.settings.youTubePlayerParams) : '');\n      video = \"<iframe allow=\\\"autoplay\\\" id=\" + videoId + \" class=\\\"lg-video-object lg-youtube \" + addClass + \"\\\" \" + videoTitle + \" src=\\\"//www.youtube.com/embed/\" + (videoInfo.youtube[1] + playerParams) + \"\\\" \" + commonIframeProps + \"></iframe>\";\n    } else if (videoInfo.vimeo) {\n      var videoId = 'lg-vimeo' + index;\n      var playerParams = getVimeoURLParams(this.settings.vimeoPlayerParams, videoInfo);\n      video = \"<iframe allow=\\\"autoplay\\\" id=\" + videoId + \" class=\\\"lg-video-object lg-vimeo \" + addClass + \"\\\" \" + videoTitle + \" src=\\\"//player.vimeo.com/video/\" + (videoInfo.vimeo[1] + playerParams) + \"\\\" \" + commonIframeProps + \"></iframe>\";\n    } else if (videoInfo.wistia) {\n      var wistiaId = 'lg-wistia' + index;\n      var playerParams = param(this.settings.wistiaPlayerParams);\n      playerParams = playerParams ? '?' + playerParams : '';\n      video = \"<iframe allow=\\\"autoplay\\\" id=\\\"\" + wistiaId + \"\\\" src=\\\"//fast.wistia.net/embed/iframe/\" + (videoInfo.wistia[4] + playerParams) + \"\\\" \" + videoTitle + \" class=\\\"wistia_embed lg-video-object lg-wistia \" + addClass + \"\\\" name=\\\"wistia_embed\\\" \" + commonIframeProps + \"></iframe>\";\n    } else if (videoInfo.html5) {\n      var html5VideoMarkup = '';\n\n      for (var i = 0; i < html5Video.source.length; i++) {\n        html5VideoMarkup += \"<source src=\\\"\" + html5Video.source[i].src + \"\\\" type=\\\"\" + html5Video.source[i].type + \"\\\">\";\n      }\n\n      if (html5Video.tracks) {\n        var _loop_1 = function (i) {\n          var trackAttributes = '';\n          var track = html5Video.tracks[i];\n          Object.keys(track || {}).forEach(function (key) {\n            trackAttributes += key + \"=\\\"\" + track[key] + \"\\\" \";\n          });\n          html5VideoMarkup += \"<track \" + trackAttributes + \">\";\n        };\n\n        for (var i = 0; i < html5Video.tracks.length; i++) {\n          _loop_1(i);\n        }\n      }\n\n      var html5VideoAttrs_1 = '';\n      var videoAttributes_1 = html5Video.attributes || {};\n      Object.keys(videoAttributes_1 || {}).forEach(function (key) {\n        html5VideoAttrs_1 += key + \"=\\\"\" + videoAttributes_1[key] + \"\\\" \";\n      });\n      video = \"<video class=\\\"lg-video-object lg-html5 \" + (this.settings.videojs && this.settings.videojsTheme ? this.settings.videojsTheme + ' ' : '') + \" \" + (this.settings.videojs ? ' video-js' : '') + \"\\\" \" + html5VideoAttrs_1 + \">\\n                \" + html5VideoMarkup + \"\\n                Your browser does not support HTML5 video.\\n            </video>\";\n    }\n\n    return video;\n  };\n  /**\r\n   * @desc - Append videos to the slide\r\n   *\r\n   * @param {HTMLElement} el - slide element\r\n   * @param {Object} videoParams - Video parameters, Contains src, class, index, htmlVideo\r\n   */\n\n\n  Video.prototype.appendVideos = function (el, videoParams) {\n    var _a;\n\n    var videoHtml = this.getVideoHtml(videoParams.src, videoParams.addClass, videoParams.index, videoParams.html5Video);\n    el.find('.lg-video-cont').append(videoHtml);\n    var $videoElement = el.find('.lg-video-object').first();\n\n    if (videoParams.html5Video) {\n      $videoElement.on('mousedown.lg.video', function (e) {\n        e.stopPropagation();\n      });\n    }\n\n    if (this.settings.videojs && ((_a = this.core.galleryItems[videoParams.index].__slideVideoInfo) === null || _a === void 0 ? void 0 : _a.html5)) {\n      try {\n        return videojs($videoElement.get(), this.settings.videojsOptions);\n      } catch (e) {\n        console.error('lightGallery:- Make sure you have included videojs');\n      }\n    }\n  };\n\n  Video.prototype.gotoNextSlideOnVideoEnd = function (src, index) {\n    var _this = this;\n\n    var $videoElement = this.core.getSlideItem(index).find('.lg-video-object').first();\n    var videoInfo = this.core.galleryItems[index].__slideVideoInfo || {};\n\n    if (this.settings.gotoNextSlideOnVideoEnd) {\n      if (videoInfo.html5) {\n        $videoElement.on('ended', function () {\n          _this.core.goToNextSlide();\n        });\n      } else if (videoInfo.vimeo) {\n        try {\n          // https://github.com/vimeo/player.js/#ended\n          new Vimeo.Player($videoElement.get()).on('ended', function () {\n            _this.core.goToNextSlide();\n          });\n        } catch (e) {\n          console.error('lightGallery:- Make sure you have included //github.com/vimeo/player.js');\n        }\n      } else if (videoInfo.wistia) {\n        try {\n          window._wq = window._wq || []; // @todo Event is gettign triggered multiple times\n\n          window._wq.push({\n            id: $videoElement.attr('id'),\n            onReady: function (video) {\n              video.bind('end', function () {\n                _this.core.goToNextSlide();\n              });\n            }\n          });\n        } catch (e) {\n          console.error('lightGallery:- Make sure you have included //fast.wistia.com/assets/external/E-v1.js');\n        }\n      }\n    }\n  };\n\n  Video.prototype.controlVideo = function (index, action) {\n    var $videoElement = this.core.getSlideItem(index).find('.lg-video-object').first();\n    var videoInfo = this.core.galleryItems[index].__slideVideoInfo || {};\n    if (!$videoElement.get()) return;\n\n    if (videoInfo.youtube) {\n      try {\n        $videoElement.get().contentWindow.postMessage(\"{\\\"event\\\":\\\"command\\\",\\\"func\\\":\\\"\" + action + \"Video\\\",\\\"args\\\":\\\"\\\"}\", '*');\n      } catch (e) {\n        console.error(\"lightGallery:- \" + e);\n      }\n    } else if (videoInfo.vimeo) {\n      try {\n        new Vimeo.Player($videoElement.get())[action]();\n      } catch (e) {\n        console.error('lightGallery:- Make sure you have included //github.com/vimeo/player.js');\n      }\n    } else if (videoInfo.html5) {\n      if (this.settings.videojs) {\n        try {\n          videojs($videoElement.get())[action]();\n        } catch (e) {\n          console.error('lightGallery:- Make sure you have included videojs');\n        }\n      } else {\n        $videoElement.get()[action]();\n      }\n    } else if (videoInfo.wistia) {\n      try {\n        window._wq = window._wq || []; // @todo Find a way to destroy wistia player instance\n\n        window._wq.push({\n          id: $videoElement.attr('id'),\n          onReady: function (video) {\n            video[action]();\n          }\n        });\n      } catch (e) {\n        console.error('lightGallery:- Make sure you have included //fast.wistia.com/assets/external/E-v1.js');\n      }\n    }\n  };\n\n  Video.prototype.loadVideoOnPosterClick = function ($el, forcePlay) {\n    var _this = this; // check slide has poster\n\n\n    if (!$el.hasClass('lg-video-loaded')) {\n      // check already video element present\n      if (!$el.hasClass('lg-has-video')) {\n        $el.addClass('lg-has-video');\n\n        var _html = void 0;\n\n        var _src = this.core.galleryItems[this.core.index].src;\n        var video = this.core.galleryItems[this.core.index].video;\n\n        if (video) {\n          _html = typeof video === 'string' ? JSON.parse(video) : video;\n        }\n\n        var videoJsPlayer_1 = this.appendVideos($el, {\n          src: _src,\n          addClass: '',\n          index: this.core.index,\n          html5Video: _html\n        });\n        this.gotoNextSlideOnVideoEnd(_src, this.core.index);\n        var $tempImg = $el.find('.lg-object').first().get(); // @todo make sure it is working\n\n        $el.find('.lg-video-cont').first().append($tempImg);\n        $el.addClass('lg-video-loading');\n        videoJsPlayer_1 && videoJsPlayer_1.ready(function () {\n          videoJsPlayer_1.on('loadedmetadata', function () {\n            _this.onVideoLoadAfterPosterClick($el, _this.core.index);\n          });\n        });\n        $el.find('.lg-video-object').first().on('load.lg error.lg loadedmetadata.lg', function () {\n          setTimeout(function () {\n            _this.onVideoLoadAfterPosterClick($el, _this.core.index);\n          }, 50);\n        });\n      } else {\n        this.playVideo(this.core.index);\n      }\n    } else if (forcePlay) {\n      this.playVideo(this.core.index);\n    }\n  };\n\n  Video.prototype.onVideoLoadAfterPosterClick = function ($el, index) {\n    $el.addClass('lg-video-loaded');\n    this.playVideo(index);\n  };\n\n  Video.prototype.destroy = function () {\n    this.core.LGel.off('.lg.video');\n    this.core.LGel.off('.video');\n  };\n\n  return Video;\n}();\n\nexport default Video;","map":{"version":3,"mappings":"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","names":["videoSettings","autoplayFirstVideo","youTubePlayerParams","vimeoPlayerParams","wistiaPlayerParams","gotoNextSlideOnVideoEnd","autoplayVideoOnSlide","videojs","videojsTheme","videojsOptions","lGEvents","afterAppendSlide","init","hasVideo","containerResize","updateSlides","afterAppendSubHtml","beforeOpen","afterOpen","slideItemLoad","beforeSlide","afterSlide","posterClick","dragStart","dragMove","dragEnd","beforeNextSlide","beforePrevSlide","beforeClose","afterClose","rotateLeft","rotateRight","flipHorizontal","flipVertical","autoplay","autoplayStart","autoplayStop","param","obj","Object","keys","map","k","encodeURIComponent","join","getVimeoURLParams","defaultParams","videoInfo","vimeo","urlParams","defaultPlayerParams","length","urlWithHash","split","pop","urlWithHashWithParams","hash","isPrivate","replace","slice","instance","core","settings","__assign","Video","LGel","on","onHasVideo","bind","$el","_this","getSlideItem","index","loadVideoOnPosterClick","onSlideItemLoad","onBeforeSlide","onAfterSlide","event","detail","isFirstSlide","setTimeout","loadAndPlayVideo","src","html5Video","hasPoster","appendVideos","addClass","lGalleryOn","prevIndex","pauseVideo","$slide","hasClass","currentGalleryItem","galleryItems","poster","playVideo","controlVideo","video","__slideVideoInfo","videoTitle","title","alt","commonIframeProps","youtube","videoId","slideUrlParams","playerParams","wistia","wistiaId","html5","html5VideoMarkup","i","source","type","tracks","trackAttributes","track","forEach","key","html5VideoAttrs_1","videoAttributes_1","attributes","el","videoParams","videoHtml","getVideoHtml","find","append","$videoElement","first","e","stopPropagation","_a","get","console","error","goToNextSlide","Vimeo","Player","window","_wq","push","id","attr","onReady","action","contentWindow","postMessage","forcePlay","_html","_src","JSON","parse","videoJsPlayer_1","$tempImg","ready","onVideoLoadAfterPosterClick","off"],"sources":["/Users/jakubstadnik/Desktop/app/lenka-design/node_modules/src/plugins/video/lg-video-settings.ts","/Users/jakubstadnik/Desktop/app/lenka-design/node_modules/src/lg-events.ts","/Users/jakubstadnik/Desktop/app/lenka-design/node_modules/src/plugins/video/lg-video-utils.ts","/Users/jakubstadnik/Desktop/app/lenka-design/node_modules/src/plugins/video/lg-video.ts"],"sourcesContent":["import { PlayerParams } from './lg-video-utils';\n\nexport interface VideoSettings {\n    /**\n     * Enable/DIsable first video autoplay.\n     * @description Autoplay has to be managed using this setting.\n     * Autoplay in PlayerParams doesn't have any effect.\n     */\n    autoplayFirstVideo: boolean;\n\n    /**\n     * Change YouTube player parameters.\n     * You can find the list of YouTube player parameters from the following link\n     * <a href=\"https://developers.google.com/youtube/player_parameters\">YouTube player parameters</a>\n     * @example\n     * lightGallery(document.getElementById('lightGallery'), {\n     *     youTubePlayerParams: {\n     *         modestbranding : 1,\n     *         showinfo : 0,\n     *         controls : 0\n     *     }\n     * })\n     */\n    youTubePlayerParams: any;\n\n    /**\n     * Change Vimeo player parameters.\n     * You can find the list of vimeo player parameters from the following link\n     * <a href=\"https://developer.vimeo.com/player/embedding#universal-parameters\">Vimeo player parameters</a>\n     * @example\n     * lightGallery(document.getElementById('lightGallery'), {\n     *     vimeoPlayerParams: {\n     *         byline : 0,\n     *         portrait : 0,\n     *         color : 'CCCCCC'\n     *     }\n     * })\n     */\n    vimeoPlayerParams: PlayerParams;\n\n    /**\n     * Change Wistia player parameters.\n     * You can find the list of Wistia player parameters from the following link\n     * <a href=\"https://wistia.com/support/developers/embed-options#using-embed-options\">Vimeo player parameters</a>\n     */\n    wistiaPlayerParams: any;\n\n    /**\n     * Go to next slide when video is ended\n     * Note - this doesn't work with YouTube videos at the moment\n     */\n    gotoNextSlideOnVideoEnd: boolean;\n\n    /**\n     * Autoplay video on slide change\n     * @description Make sure you set preload:\"none\"\n     */\n    autoplayVideoOnSlide: boolean;\n\n    /**\n     * Enbale videojs custom video player\n     * <div class=\"alert alert-info\" role=\"alert\">\n     *     <b>Dependency</b> - You need to include <a href=\"https://videojs.com/\">videoJs</a> on your document to enable videojs player\n     * </div>\n     */\n    videojs: boolean;\n\n    /**\n     * Class name of the videojs theme\n     * You need to include the theme stylesheet on your document. <a href=\"https://videojs.com/getting-started/#home-page-themes\" target=\"_blank\">More info</a>\n     * @version V2.5.0\n     */\n    videojsTheme: string;\n\n    /**\n     * Videojs player options\n     */\n    videojsOptions: any;\n}\nexport const videoSettings: VideoSettings = {\n    autoplayFirstVideo: true,\n    youTubePlayerParams: false,\n    vimeoPlayerParams: false,\n    wistiaPlayerParams: false,\n    gotoNextSlideOnVideoEnd: true,\n    autoplayVideoOnSlide: false,\n    videojs: false,\n    videojsTheme: '',\n    videojsOptions: {},\n};\n","import { LightGallery } from './lightgallery';\nimport { VideoSource } from './plugins/video/types';\n\n/**\n * List of lightGallery events\n * All events should be documented here\n * Below interfaces are used to build the website documentations\n * */\nexport const lGEvents: {\n    [key: string]: string;\n} = {\n    afterAppendSlide: 'lgAfterAppendSlide',\n    init: 'lgInit',\n    hasVideo: 'lgHasVideo',\n    containerResize: 'lgContainerResize',\n    updateSlides: 'lgUpdateSlides',\n    afterAppendSubHtml: 'lgAfterAppendSubHtml',\n    beforeOpen: 'lgBeforeOpen',\n    afterOpen: 'lgAfterOpen',\n    slideItemLoad: 'lgSlideItemLoad',\n    beforeSlide: 'lgBeforeSlide',\n    afterSlide: 'lgAfterSlide',\n    posterClick: 'lgPosterClick',\n    dragStart: 'lgDragStart',\n    dragMove: 'lgDragMove',\n    dragEnd: 'lgDragEnd',\n    beforeNextSlide: 'lgBeforeNextSlide',\n    beforePrevSlide: 'lgBeforePrevSlide',\n    beforeClose: 'lgBeforeClose',\n    afterClose: 'lgAfterClose',\n    rotateLeft: 'lgRotateLeft',\n    rotateRight: 'lgRotateRight',\n    flipHorizontal: 'lgFlipHorizontal',\n    flipVertical: 'lgFlipVertical',\n    autoplay: 'lgAutoplay',\n    autoplayStart: 'lgAutoplayStart',\n    autoplayStop: 'lgAutoplayStop',\n};\n\n// Follow the below format for the event documentation\n// @method is the method name when event is used with Angular/React components\n\n/**\n * Fired only once when lightGallery is initialized\n * @name lgInit\n * @method onInit\n * @example\n *   const lg = document.getElementById('custom-events-demo');\n *   // Perform any action on lightGallery initialization.\n *   // Init event returns the plugin instance that can be used to call any lightGalley public method\n *   let pluginInstance = null;\n *   lg.addEventListener('lgInit', (event) => {\n *      pluginInstance = event.detail.instance;\n *   });\n *   lightGallery(lg);\n * @see <a href=\"/docs/methods\">Methods<a>\n */\nexport interface InitDetail {\n    /**\n     * lightGallery plugin instance\n     */\n    instance: LightGallery;\n}\n\n/**\n * Fired when the slide content has been inserted into it's slide container.\n * @name lgAfterAppendSlide\n * @method onAfterAppendSlide\n */\nexport interface AfterAppendSlideEventDetail {\n    /**\n     * Index of the slide\n     */\n    index: number;\n}\n\n/**\n * Fired immediately before opening the gallery\n * @name lgBeforeOpen\n * @method onBeforeOpen\n */\nexport interface BeforeOpenDetail {}\n\n/**\n * Fired immediately after opening the gallery\n * @name lgAfterOpen\n * @method onAfterOpen\n */\nexport interface AfterOpenDetail {}\n\n/**\n * Fired once the media inside the slide has been completely loaded .\n * @name lgSlideItemLoad\n * @method onSlideItemLoad\n */\nexport interface SlideItemLoadDetail {\n    /**\n     * Index of the slide\n     */\n    index: number;\n    /**\n     * For the first slide, lightGallery adds some delay for displaying the loaded slide item.\n     * This delay is required for the transition effect when the slide item is displayed\n     * Respect the delay when you use this event\n     */\n    delay: number;\n\n    // Will be true for the first slide\n    isFirstSlide: boolean;\n}\n\n/**\n * Fired immediately before each slide transition.\n * @name lgBeforeSlide\n * @method onBeforeSlide\n * @example\n *   const lg = document.getElementById('custom-events-demo');\n *   // Perform any action before each slide transition\n *   lg.addEventListener('lgBeforeSlide', (event) => {\n *       const { index, prevIndex } = event.detail;\n *       alert(index, prevIndex);\n *   });\n *   lightGallery(lg);\n */\nexport interface BeforeSlideDetail {\n    /**\n     * Index of the previous slide\n     */\n    prevIndex: number;\n    /**\n     * Index of the slide\n     */\n    index: number;\n    /**\n     * true if slide function called via touch event or mouse drag\n     */\n    fromTouch: boolean;\n    /**\n     * true if slide function called via thumbnail click\n     */\n    fromThumb: boolean;\n}\n\n/**\n * Fired immediately after each slide transition.\n * @name lgAfterSlide\n * @method onAfterSlide\n */\nexport interface AfterSlideDetail {\n    /**\n     * Index of the previous slide\n     */\n    prevIndex: number;\n    /**\n     * Index of the slide\n     */\n    index: number;\n    /**\n     * true if slide function called via touch event or mouse drag\n     */\n    fromTouch: boolean;\n    /**\n     * true if slide function called via thumbnail click\n     */\n    fromThumb: boolean;\n}\n\n/**\n * Fired when the video poster is clicked.\n * @name lgPosterClick\n * @method onPosterClick\n */\nexport interface PosterClickDetail {}\n\n/**\n * Fired when the drag event to move to different slide starts.\n * @name lgDragStart\n * @method onDragStart\n */\nexport interface DragStartDetail {}\n\n/**\n * Fired periodically during the drag operation.\n * @name lgDragMove\n * @method onDragMove\n */\nexport interface DragMoveDetail {}\n\n/**\n * Fired when the user has finished the drag operation\n * @name lgDragEnd\n * @method onDragEnd\n */\nexport interface DragEndDetail {}\n\n/**\n * Fired immediately before the start of the close process.\n * @name lgBeforeClose\n * @method onBeforeClose\n */\nexport interface BeforeCloseDetail {}\n\n/**\n * Fired immediately once lightGallery is closed.\n * @name lgAfterClose\n * @method onAfterClose\n */\nexport interface AfterCloseDetail {\n    /**\n     * lightGallery plugin instance\n     */\n    instance: LightGallery;\n}\n\n/**\n * Fired immediately before each \"next\" slide transition\n * @name lgBeforeNextSlide\n * @method onBeforeNextSlide\n */\nexport interface BeforeNextSlideDetail {\n    /**\n     * Index of the slide\n     */\n    index: number;\n    /**\n     * true if slide function called via touch event or mouse drag\n     */\n    fromTouch: boolean;\n}\n\n/**\n * Fired immediately before each \"prev\" slide transition\n * @name lgBeforePrevSlide\n * @method onBeforePrevSlide\n */\nexport interface BeforePrevSlideDetail {\n    /**\n     * Index of the slide\n     */\n    index: number;\n    /**\n     * true if slide function called via touch event or mouse drag\n     */\n    fromTouch: boolean;\n}\n\n/**\n * Fired when the sub-html content (ex : title/ description) has been appended into the slide.\n * @name lgAfterAppendSubHtml\n * @method onAfterAppendSubHtml\n */\nexport interface AfterAppendSubHtmlDetail {\n    /**\n     * Index of the slide\n     */\n    index: number;\n}\n\n/**\n * Fired when the lightGallery container has been resized.\n * @name lgContainerResize\n * @method onContainerResize\n */\nexport interface ContainerResizeDetail {\n    /**\n     * Index of the slide\n     */\n    index: number;\n}\n\n/**\n * Fired when lightGallery detects video slide\n * @name lgHasVideo\n * @method onHasVideo\n */\nexport interface HasVideoDetail {\n    /**\n     * Index of the slide,\n     */\n    index: number;\n    /**\n     * Video source\n     */\n    src: string;\n    /**\n     * HTML5 video source if available\n     * <p>\n       HTML5 video source = source: {\n            src: string;\n            type: string;\n        }[];\n        attributes: HTMLVideoElement;\n     * </p>\n     */\n    html5Video: VideoSource;\n    /**\n     * True if video has poster\n     */\n    hasPoster: boolean;\n}\n\n/**\n * Fired when the image is rotated in anticlockwise direction\n * @name lgRotateLeft\n * @method onRotateLeft\n */\nexport interface RotateLeftDetail {\n    /**\n     * Index of the slide\n     */\n    index: number;\n}\n\n/**\n * Fired when the image is rotated in clockwise direction\n * @name lgRotateRight\n * @method onRotateRight\n */\nexport interface RotateRightDetail {\n    /**\n     * Index of the slide\n     */\n    index: number;\n}\n\n/**\n * Fired when the image is flipped horizontally\n * @name lgFlipHorizontal\n * @method onFlipHorizontal\n */\nexport interface FlipHorizontalDetail {\n    /**\n     * Index of the slide\n     */\n    index: number;\n}\n\n/**\n * Fired when the image is flipped vertically\n * @name lgFlipVertical\n * @method onFlipVertical\n */\nexport interface FlipVerticalDetail {\n    /**\n     * Index of the slide\n     */\n    index: number;\n}\n","import { VideoInfo } from '../../types';\nexport type PlayerParams = Record<string, string | number | boolean> | boolean;\n\nexport const param = (obj: {\n    [x: string]: string | number | boolean;\n}): string => {\n    return Object.keys(obj)\n        .map(function (k) {\n            return encodeURIComponent(k) + '=' + encodeURIComponent(obj[k]);\n        })\n        .join('&');\n};\nexport const getVimeoURLParams = (\n    defaultParams: PlayerParams,\n    videoInfo?: VideoInfo,\n): string => {\n    if (!videoInfo || !videoInfo.vimeo) return '';\n    let urlParams = videoInfo.vimeo[2] || '';\n\n    const defaultPlayerParams =\n        defaultParams && Object.keys(defaultParams).length !== 0\n            ? '&' + param(defaultParams as any)\n            : '';\n\n    // Support private video\n    const urlWithHash = videoInfo.vimeo[0].split('/').pop() || '';\n    const urlWithHashWithParams = urlWithHash.split('?')[0] || '';\n    const hash = urlWithHashWithParams.split('#')[0];\n\n    const isPrivate = videoInfo.vimeo[1] !== hash;\n    if (isPrivate) {\n        urlParams = urlParams.replace(`/${hash}`, '');\n    }\n\n    urlParams =\n        urlParams[0] == '?' ? '&' + urlParams.slice(1) : urlParams || '';\n\n    // For vimeo last params gets priority if duplicates found\n    const vimeoPlayerParams = `?autoplay=0&muted=1${\n        isPrivate ? `&h=${hash}` : ''\n    }${defaultPlayerParams}${urlParams}`;\n    return vimeoPlayerParams;\n};\n","/**\n * Video module for lightGallery\n * Supports HTML5, YouTube, Vimeo, wistia videos\n *\n *\n * @ref Wistia\n * https://wistia.com/support/integrations/wordpress(How to get url)\n * https://wistia.com/support/developers/embed-options#using-embed-options\n * https://wistia.com/support/developers/player-api\n * https://wistia.com/support/developers/construct-an-embed-code\n * http://jsfiddle.net/xvnm7xLm/\n * https://developer.mozilla.org/en-US/docs/Web/HTML/Element/video\n * https://wistia.com/support/embed-and-share/sharing-videos\n * https://private-sharing.wistia.com/medias/mwhrulrucj\n *\n * @ref Youtube\n * https://developers.google.com/youtube/player_parameters#enablejsapi\n * https://developers.google.com/youtube/iframe_api_reference\n * https://developer.chrome.com/blog/autoplay/#iframe-delegation\n *\n * @ref Vimeo\n * https://stackoverflow.com/questions/10488943/easy-way-to-get-vimeo-id-from-a-vimeo-url\n * https://vimeo.zendesk.com/hc/en-us/articles/360000121668-Starting-playback-at-a-specific-timecode\n * https://vimeo.zendesk.com/hc/en-us/articles/360001494447-Using-Player-Parameters\n */\n\nimport { VideoSettings, videoSettings } from './lg-video-settings';\nimport { LightGallery } from '../../lightgallery';\nimport { lgQuery } from '../../lgQuery';\nimport {\n    CustomEventAfterSlide,\n    CustomEventHasVideo,\n    CustomEventSlideItemLoad,\n    VideoInfo,\n} from '../../types';\nimport { lGEvents } from '../../lg-events';\nimport { VideoSource } from './types';\nimport { getVimeoURLParams, param } from './lg-video-utils';\n\ndeclare let Vimeo: any;\ndeclare let videojs: any;\ndeclare global {\n    interface Window {\n        _wq: any;\n        Vimeo: any;\n    }\n}\nexport default class Video {\n    private core: LightGallery;\n    private settings: VideoSettings;\n    constructor(instance: LightGallery) {\n        // get lightGallery core plugin instance\n        this.core = instance;\n        this.settings = { ...videoSettings, ...this.core.settings };\n\n        return this;\n    }\n    init() {\n        /**\n         * Event triggered when video url found without poster\n         * Append video HTML\n         * Play if autoplayFirstVideo is true\n         */\n        this.core.LGel.on(\n            `${lGEvents.hasVideo}.video`,\n            this.onHasVideo.bind(this),\n        );\n\n        this.core.LGel.on(`${lGEvents.posterClick}.video`, () => {\n            const $el = this.core.getSlideItem(this.core.index);\n            this.loadVideoOnPosterClick($el);\n        });\n        this.core.LGel.on(\n            `${lGEvents.slideItemLoad}.video`,\n            this.onSlideItemLoad.bind(this),\n        );\n\n        // @desc fired immediately before each slide transition.\n        this.core.LGel.on(\n            `${lGEvents.beforeSlide}.video`,\n            this.onBeforeSlide.bind(this),\n        );\n\n        // @desc fired immediately after each slide transition.\n        this.core.LGel.on(\n            `${lGEvents.afterSlide}.video`,\n            this.onAfterSlide.bind(this),\n        );\n    }\n\n    /**\n     * @desc Event triggered when a slide is completely loaded\n     *\n     * @param {Event} event - lightGalley custom event\n     */\n    onSlideItemLoad(event: CustomEventSlideItemLoad): void {\n        const { isFirstSlide, index } = event.detail;\n\n        // Should check the active slide as well as user may have moved to different slide before the first slide is loaded\n        if (\n            this.settings.autoplayFirstVideo &&\n            isFirstSlide &&\n            index === this.core.index\n        ) {\n            // Delay is just for the transition effect on video load\n            setTimeout(() => {\n                this.loadAndPlayVideo(index);\n            }, 200);\n        }\n\n        // Should not call on first slide. should check only if the slide is active\n        if (\n            !isFirstSlide &&\n            this.settings.autoplayVideoOnSlide &&\n            index === this.core.index\n        ) {\n            this.loadAndPlayVideo(index);\n        }\n    }\n\n    /**\n     * @desc Event triggered when video url or poster found\n     * Append video HTML is poster is not given\n     * Play if autoplayFirstVideo is true\n     *\n     * @param {Event} event - Javascript Event object.\n     */\n    onHasVideo(event: CustomEventHasVideo): void {\n        const { index, src, html5Video, hasPoster } = event.detail;\n        if (!hasPoster) {\n            // All functions are called separately if poster exist in loadVideoOnPosterClick function\n\n            this.appendVideos(this.core.getSlideItem(index), {\n                src,\n                addClass: 'lg-object',\n                index,\n                html5Video,\n            });\n\n            // Automatically navigate to next slide once video reaches the end.\n            this.gotoNextSlideOnVideoEnd(src, index);\n        }\n    }\n\n    /**\n     * @desc fired immediately before each slide transition.\n     * Pause the previous video\n     * Hide the download button if the slide contains YouTube, Vimeo, or Wistia videos.\n     *\n     * @param {Event} event - Javascript Event object.\n     * @param {number} prevIndex - Previous index of the slide.\n     * @param {number} index - Current index of the slide\n     */\n    onBeforeSlide(event: CustomEvent): void {\n        if (this.core.lGalleryOn) {\n            const { prevIndex } = event.detail;\n            this.pauseVideo(prevIndex);\n        }\n    }\n\n    /**\n     * @desc fired immediately after each slide transition.\n     * Play video if autoplayVideoOnSlide option is enabled.\n     *\n     * @param {Event} event - Javascript Event object.\n     * @param {number} prevIndex - Previous index of the slide.\n     * @param {number} index - Current index of the slide\n     * @todo should check on onSlideLoad as well if video is not loaded on after slide\n     */\n    onAfterSlide(event: CustomEventAfterSlide): void {\n        const { index, prevIndex } = event.detail;\n        // Do not call on first slide\n        const $slide = this.core.getSlideItem(index);\n        if (this.settings.autoplayVideoOnSlide && index !== prevIndex) {\n            if ($slide.hasClass('lg-complete')) {\n                setTimeout(() => {\n                    this.loadAndPlayVideo(index);\n                }, 100);\n            }\n        }\n    }\n\n    loadAndPlayVideo(index: number): void {\n        const $slide = this.core.getSlideItem(index);\n        const currentGalleryItem = this.core.galleryItems[index];\n        if (currentGalleryItem.poster) {\n            this.loadVideoOnPosterClick($slide, true);\n        } else {\n            this.playVideo(index);\n        }\n    }\n\n    /**\n     * Play HTML5, Youtube, Vimeo or Wistia videos in a particular slide.\n     * @param {number} index - Index of the slide\n     */\n    playVideo(index: number) {\n        this.controlVideo(index, 'play');\n    }\n\n    /**\n     * Pause HTML5, Youtube, Vimeo or Wistia videos in a particular slide.\n     * @param {number} index - Index of the slide\n     */\n    pauseVideo(index: number) {\n        this.controlVideo(index, 'pause');\n    }\n\n    getVideoHtml(\n        src: any,\n        addClass: any,\n        index: number,\n        html5Video: VideoSource,\n    ): string {\n        let video = '';\n        const videoInfo =\n            this.core.galleryItems[(index as unknown) as number]\n                .__slideVideoInfo || {};\n        const currentGalleryItem = this.core.galleryItems[index];\n        let videoTitle = currentGalleryItem.title || currentGalleryItem.alt;\n        videoTitle = videoTitle ? 'title=\"' + videoTitle + '\"' : '';\n        const commonIframeProps = `allowtransparency=\"true\"\n            frameborder=\"0\"\n            scrolling=\"no\"\n            allowfullscreen\n            mozallowfullscreen\n            webkitallowfullscreen\n            oallowfullscreen\n            msallowfullscreen`;\n\n        if (videoInfo.youtube) {\n            const videoId = 'lg-youtube' + index;\n\n            const slideUrlParams = videoInfo.youtube[2]\n                ? videoInfo.youtube[2] + '&'\n                : '';\n            // For youtube first parms gets priority if duplicates found\n            const youTubePlayerParams = `?${slideUrlParams}wmode=opaque&autoplay=0&mute=1&enablejsapi=1`;\n\n            const playerParams =\n                youTubePlayerParams +\n                (this.settings.youTubePlayerParams\n                    ? '&' + param(this.settings.youTubePlayerParams)\n                    : '');\n\n            video = `<iframe allow=\"autoplay\" id=${videoId} class=\"lg-video-object lg-youtube ${addClass}\" ${videoTitle} src=\"//www.youtube.com/embed/${\n                videoInfo.youtube[1] + playerParams\n            }\" ${commonIframeProps}></iframe>`;\n        } else if (videoInfo.vimeo) {\n            const videoId = 'lg-vimeo' + index;\n            const playerParams = getVimeoURLParams(\n                this.settings.vimeoPlayerParams,\n                videoInfo,\n            );\n            video = `<iframe allow=\"autoplay\" id=${videoId} class=\"lg-video-object lg-vimeo ${addClass}\" ${videoTitle} src=\"//player.vimeo.com/video/${\n                videoInfo.vimeo[1] + playerParams\n            }\" ${commonIframeProps}></iframe>`;\n        } else if (videoInfo.wistia) {\n            const wistiaId = 'lg-wistia' + index;\n            let playerParams = param(this.settings.wistiaPlayerParams);\n            playerParams = playerParams ? '?' + playerParams : '';\n            video = `<iframe allow=\"autoplay\" id=\"${wistiaId}\" src=\"//fast.wistia.net/embed/iframe/${\n                videoInfo.wistia[4] + playerParams\n            }\" ${videoTitle} class=\"wistia_embed lg-video-object lg-wistia ${addClass}\" name=\"wistia_embed\" ${commonIframeProps}></iframe>`;\n        } else if (videoInfo.html5) {\n            let html5VideoMarkup = '';\n            for (let i = 0; i < html5Video.source.length; i++) {\n                html5VideoMarkup += `<source src=\"${html5Video.source[i].src}\" type=\"${html5Video.source[i].type}\">`;\n            }\n            if (html5Video.tracks) {\n                for (let i = 0; i < html5Video.tracks.length; i++) {\n                    let trackAttributes = '';\n                    const track = html5Video.tracks[i];\n                    Object.keys(track || {}).forEach(function (key) {\n                        trackAttributes += `${key}=\"${(track as any)[key]}\" `;\n                    });\n                    html5VideoMarkup += `<track ${trackAttributes}>`;\n                }\n            }\n\n            let html5VideoAttrs = '';\n            const videoAttributes = html5Video.attributes || {};\n            Object.keys(videoAttributes || {}).forEach(function (key) {\n                html5VideoAttrs += `${key}=\"${(videoAttributes as any)[key]}\" `;\n            });\n            video = `<video class=\"lg-video-object lg-html5 ${\n                this.settings.videojs && this.settings.videojsTheme\n                    ? this.settings.videojsTheme + ' '\n                    : ''\n            } ${this.settings.videojs ? ' video-js' : ''}\" ${html5VideoAttrs}>\n                ${html5VideoMarkup}\n                Your browser does not support HTML5 video.\n            </video>`;\n        }\n\n        return video;\n    }\n\n    /**\n     * @desc - Append videos to the slide\n     *\n     * @param {HTMLElement} el - slide element\n     * @param {Object} videoParams - Video parameters, Contains src, class, index, htmlVideo\n     */\n    appendVideos(\n        el: lgQuery,\n        videoParams: {\n            src: string;\n            addClass: string;\n            index: number;\n            html5Video: any;\n        },\n    ): any {\n        const videoHtml = this.getVideoHtml(\n            videoParams.src,\n            videoParams.addClass,\n            videoParams.index,\n            videoParams.html5Video,\n        );\n        el.find('.lg-video-cont').append(videoHtml);\n        const $videoElement = el.find('.lg-video-object').first();\n        if (videoParams.html5Video) {\n            $videoElement.on('mousedown.lg.video', (e) => {\n                e.stopPropagation();\n            });\n        }\n        if (\n            this.settings.videojs &&\n            this.core.galleryItems[videoParams.index].__slideVideoInfo?.html5\n        ) {\n            try {\n                return videojs(\n                    $videoElement.get(),\n                    this.settings.videojsOptions,\n                );\n            } catch (e) {\n                console.error(\n                    'lightGallery:- Make sure you have included videojs',\n                );\n            }\n        }\n    }\n\n    gotoNextSlideOnVideoEnd(src: any, index: number) {\n        const $videoElement = this.core\n            .getSlideItem(index)\n            .find('.lg-video-object')\n            .first();\n        const videoInfo = this.core.galleryItems[index].__slideVideoInfo || {};\n        if (this.settings.gotoNextSlideOnVideoEnd) {\n            if (videoInfo.html5) {\n                $videoElement.on('ended', () => {\n                    this.core.goToNextSlide();\n                });\n            } else if (videoInfo.vimeo) {\n                try {\n                    // https://github.com/vimeo/player.js/#ended\n                    new Vimeo.Player($videoElement.get()).on('ended', () => {\n                        this.core.goToNextSlide();\n                    });\n                } catch (e) {\n                    console.error(\n                        'lightGallery:- Make sure you have included //github.com/vimeo/player.js',\n                    );\n                }\n            } else if (videoInfo.wistia) {\n                try {\n                    window._wq = window._wq || [];\n\n                    // @todo Event is gettign triggered multiple times\n                    window._wq.push({\n                        id: $videoElement.attr('id'),\n                        onReady: (video: {\n                            bind: (arg0: string, arg1: () => void) => void;\n                        }) => {\n                            video.bind('end', () => {\n                                this.core.goToNextSlide();\n                            });\n                        },\n                    });\n                } catch (e) {\n                    console.error(\n                        'lightGallery:- Make sure you have included //fast.wistia.com/assets/external/E-v1.js',\n                    );\n                }\n            }\n        }\n    }\n\n    controlVideo(index: number, action: string) {\n        const $videoElement = this.core\n            .getSlideItem(index)\n            .find('.lg-video-object')\n            .first();\n        const videoInfo = this.core.galleryItems[index].__slideVideoInfo || {};\n\n        if (!$videoElement.get()) return;\n\n        if (videoInfo.youtube) {\n            try {\n                ($videoElement.get() as any).contentWindow.postMessage(\n                    `{\"event\":\"command\",\"func\":\"${action}Video\",\"args\":\"\"}`,\n                    '*',\n                );\n            } catch (e) {\n                console.error(`lightGallery:- ${e}`);\n            }\n        } else if (videoInfo.vimeo) {\n            try {\n                new Vimeo.Player($videoElement.get())[action]();\n            } catch (e) {\n                console.error(\n                    'lightGallery:- Make sure you have included //github.com/vimeo/player.js',\n                );\n            }\n        } else if (videoInfo.html5) {\n            if (this.settings.videojs) {\n                try {\n                    (videojs($videoElement.get()) as any)[action as any]();\n                } catch (e) {\n                    console.error(\n                        'lightGallery:- Make sure you have included videojs',\n                    );\n                }\n            } else {\n                ($videoElement.get() as any)[action]();\n            }\n        } else if (videoInfo.wistia) {\n            try {\n                window._wq = window._wq || [];\n\n                // @todo Find a way to destroy wistia player instance\n                window._wq.push({\n                    id: $videoElement.attr('id'),\n                    onReady: (video: any) => {\n                        video[action]();\n                    },\n                });\n            } catch (e) {\n                console.error(\n                    'lightGallery:- Make sure you have included //fast.wistia.com/assets/external/E-v1.js',\n                );\n            }\n        }\n    }\n\n    loadVideoOnPosterClick($el: lgQuery, forcePlay?: boolean): void {\n        // check slide has poster\n        if (!$el.hasClass('lg-video-loaded')) {\n            // check already video element present\n            if (!$el.hasClass('lg-has-video')) {\n                $el.addClass('lg-has-video');\n\n                let _html;\n\n                const _src = this.core.galleryItems[this.core.index].src;\n                const video = this.core.galleryItems[this.core.index].video;\n                if (video) {\n                    _html =\n                        typeof video === 'string' ? JSON.parse(video) : video;\n                }\n\n                const videoJsPlayer = this.appendVideos($el, {\n                    src: _src as string,\n                    addClass: '',\n                    index: this.core.index,\n                    html5Video: _html,\n                });\n\n                this.gotoNextSlideOnVideoEnd(_src, this.core.index);\n\n                const $tempImg = $el.find('.lg-object').first().get();\n\n                // @todo make sure it is working\n                $el.find('.lg-video-cont').first().append($tempImg);\n                $el.addClass('lg-video-loading');\n\n                videoJsPlayer &&\n                    videoJsPlayer.ready(() => {\n                        videoJsPlayer.on('loadedmetadata', () => {\n                            this.onVideoLoadAfterPosterClick(\n                                $el,\n                                this.core.index,\n                            );\n                        });\n                    });\n\n                $el.find('.lg-video-object')\n                    .first()\n                    .on('load.lg error.lg loadedmetadata.lg', () => {\n                        setTimeout(() => {\n                            this.onVideoLoadAfterPosterClick(\n                                $el,\n                                this.core.index,\n                            );\n                        }, 50);\n                    });\n            } else {\n                this.playVideo(this.core.index);\n            }\n        } else if (forcePlay) {\n            this.playVideo(this.core.index);\n        }\n    }\n    onVideoLoadAfterPosterClick($el: lgQuery, index: number): void {\n        $el.addClass('lg-video-loaded');\n        this.playVideo(index);\n    }\n    destroy(): void {\n        this.core.LGel.off('.lg.video');\n        this.core.LGel.off('.video');\n    }\n}\n"]},"metadata":{},"sourceType":"module"}